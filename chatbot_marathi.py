# Required Libraries
import tkinter as tk
import nltk
import numpy as np
import random
import string
import speech_recognition as sr
import pyttsx3
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity
import pyttsx3

# Initialize Text-to-Speech Engine
engine = pyttsx3.init()
def fun():
# Sample Health Data
    corpus = [
        'माझं डोकं दुखतंय.',
        'माझ्या पोटात दुखतंय.',
        'मला मळमळ वाटते.',
        'मला ताप आलाय.',
        'मला खोकला झाला आहे.',
        'मला सतत थकवा जाणवतो.',
        'मला श्वासोच्छवासाचा त्रास होतो.',
        'मला छातीत दुखत आहे.',
        'माझा घसा खवखवतोय.',
        'मला जुलाब झाला आहे.',
        'मला बद्धकोष्ठता आहे.',
        'मला पाठदुखी आहे.',
        'मला चक्कर येत आहे.',
        'मला त्वचेवर पुरळ आहे.',
        'मला नाक वाहते.',
        'मला काळजी वाटते.',
        'मला झोपायला त्रास होतो.',
        'मला अस्पष्ट दृष्टी आहे.',
        'मला उदास वाटते.',
        'मला सांधेदुखी आहे.',
        'मला स्नायू क्रॅम्प आहेत.',
        'मला उच्च रक्तदाब आहे.',
        'मला मधुमेह आहे.',
        'मला दमा आहे.',
        'मला ऍलर्जी आहे.',
        'मला संधिवात आहे.',
        'मला मायग्रेन आहे.',
        'मला एक्जिमा आहे.',
        'मला पुरळ आहे.',
        'मला मूत्रमार्गात संसर्ग झाला आहे.',
        'मला यीस्ट इन्फेक्शन आहे.',
        'मला दातदुखी आहे.',
        'मला सर्दी आहे.',
        'माझ्या पोटात विषाणू आहे.',
        'मला सायनस इन्फेक्शन आहे.',
        'माझ्या घोट्याला मोच आली आहे.',
        'माझं हाड तुटलं आहे.',
        'माझ्याकडे कट आहे.',
        'मला एक जखम आहे.',
        'मला आघात झाला आहे.',
        'माझ्या पाठीत दुखत आहे.',
        'मला मान दुखत आहे.',
        'मला खांदा दुखत आहे.',
        'मला गुडघा दुखत आहे.',
        'मला हिप दुखत आहे.',
        'मला कोपर दुखत आहे.',
        'मला मनगटात दुखत आहे.',
        'मला घोट्यात दुखत आहे.',
        'मला पाय दुखत आहे.',
        'मला पायाचे बोट दुखत आहे.',
        'माझ्या हातावर पुरळ उठली आहे.',
        'माझ्या पायावर पुरळ उठली आहे.',
        'माझ्या चेहऱ्यावर पुरळ उठली आहे.',
        'माझ्या छातीवर पुरळ आहे.',
        'माझ्या पाठीवर पुरळ आहे.',
        'माझ्या पोटात पुरळ आहे.',
    ]

    # Sample Health Rules
    rules = {
        'डोक': 'भरपूर पाणी प्या आणि शांत, खोलीत आराम करण्याचा प्रयत्न करा.',
        'डोकेदुखी': 'भरपूर पाणी प्या आणि शांत,  खोलीत आराम करण्याचा प्रयत्न करा.',
        'पोटदुखी': 'मसालेदार किंवा स्निग्ध पदार्थ टाळा आणि आल्याचा चहा पिण्याचा प्रयत्न करा.',
        'मळमळ': 'जड किंवा स्निग्ध पदार्थ टाळा, आणि पोट स्थिर करण्यासाठी आल्याचा चहा किंवा आल्याचा आळे पिण्याचा प्रयत्न करा.',
        'ताप': 'विश्रांती घ्या, द्रवपदार्थ प्या आणि ॲसिटामिनोफेन किंवा आयबुप्रोफेन सारखे ताप कमी करणारे ओव्हर-द-काउंटर घ्या.',
        'खोकला': 'हायड्रेटेड राहा आणि ओव्हर-द-काउंटर खोकल्याची औषधे वापरून पहा.  खोकला कायम राहिल्यास डॉक्टरांना भेटा.',
        'थकवा': 'तुम्हाला पुरेशी झोप मिळत असल्याची आणि निरोगी आहाराची खात्री करा.  विश्रांती तंत्राद्वारे तणाव कमी करण्याचा विचार करा.',
        'श्वास लागणे': 'सरळ बसा आणि शांत राहण्याचा प्रयत्न करा.  लक्षणे कायम राहिल्यास ताबडतोब वैद्यकीय मदत घ्या.',
        'छातीत दुखणे': 'तत्काळ वैद्यकीय मदत घ्या.  छातीत दुखण्याकडे दुर्लक्ष करू नका कारण ते हृदयविकाराचा झटका किंवा इतर गंभीर स्थितीचे लक्षण असू शकते.',
        'घसा खवखवणे': 'कोमट मिठाच्या पाण्याने गारगल करा आणि भरपूर द्रव प्या.  ओव्हर-द-काउंटर घशातील लोझेंज देखील आराम देऊ शकतात.',
        'अतिसार': 'स्पष्ट द्रवपदार्थांसह हायड्रेटेड रहा आणि केळी, तांदूळ आणि टोस्ट यांसारखे हलके, पचायला सोपे पदार्थ खा.',
        'बद्धकोष्ठता': 'फळे, भाज्या आणि संपूर्ण धान्यांसह फायबरचे सेवन वाढवा.  भरपूर पाणी प्या आणि हलका व्यायाम करा.',
        'पाठदुखी': 'प्रभावित भागात उष्णता किंवा थंड पॅक लावा आणि हलके ताणून पहा.  ओव्हर-द-काउंटर वेदना कमी करणारे देखील मदत करू शकतात.',
        'चक्कर येणे': 'चक्कर कमी होईपर्यंत बसा किंवा झोपा आणि विश्रांती घ्या.  अचानक हालचाली टाळा.  चक्कर येत राहिल्यास डॉक्टरांना भेटा.',
        'त्वचेवर पुरळ': 'प्रभावित क्षेत्र स्वच्छ आणि कोरडे ठेवा.  पुरळ खाजवणे टाळा.  ओव्हर-द-काउंटर हायड्रोकॉर्टिसोन क्रीम खाज कमी करण्यास मदत करू शकते.',
        'वाहणारे नाक': 'रंजकता कमी करण्यासाठी आणि अनुनासिक परिच्छेद ओलसर ठेवण्यासाठी सलाईन नाक स्प्रे वापरा.  ओव्हर-द-काउंटर डिकंजेस्टंट देखील आराम देऊ शकतात.',
        'चिंता': 'चिंता व्यवस्थापित करण्यात मदत करण्यासाठी खोल श्वासोच्छवासाचे व्यायाम, ध्यान किंवा योगाचा सराव करा.  जर चिंता दैनंदिन जीवनात व्यत्यय आणत असेल तर व्यावसायिक मदत घेण्याचा विचार करा.',
        'झोपण्यात अडचण': 'नियमित झोपेचे वेळापत्रक तयार करा आणि आरामशीर झोपण्याच्या वेळेची दिनचर्या तयार करा.  झोपायच्या आधी कॅफिन आणि इलेक्ट्रॉनिक्स टाळा.',
        'अस्पष्ट दृष्टी': 'तुमच्या डोळ्यांना विश्रांती द्या आणि इलेक्ट्रॉनिक उपकरणे वाचताना किंवा वापरताना योग्य प्रकाशाची खात्री करा.  दृष्टी बदलत राहिल्यास डोळ्यांच्या डॉक्टरांना भेटा.',
        'डिप्रेशन': 'समर्थनासाठी मित्र, कुटुंब किंवा मानसिक आरोग्य व्यावसायिकांशी संपर्क साधा.  स्वत: ची काळजी घेण्याच्या क्रियाकलापांचा सराव करा आणि आवश्यक असल्यास थेरपी किंवा औषधांचा विचार करा.',
        'सांधेदुखी': 'प्रभावित सांध्यावर बर्फ किंवा उष्मा पॅक लावा आणि हलके स्ट्रेच किंवा व्यायाम करून पहा.  ओव्हर-द-काउंटर वेदना कमी करणारे देखील मदत करू शकतात.',
        'स्नायू पेटके': 'प्रभावित स्नायू ताणून मालिश करा.  भरपूर द्रव प्या आणि तुम्हाला पोटॅशियम आणि मॅग्नेशियम सारखे पुरेसे इलेक्ट्रोलाइट्स मिळत असल्याची खात्री करा.',
        'उच्च रक्तदाब': 'सोडियमचे प्रमाण कमी आणि फळे, भाज्या आणि संपूर्ण धान्ये असलेले निरोगी आहाराचे पालन करा.  नियमित व्यायाम करा आणि धूम्रपान आणि जास्त मद्यपान टाळा.',
        'मधुमेह': 'रक्तातील साखरेच्या पातळीचे नियमित निरीक्षण करा आणि संतुलित आहार घ्या.  लिहून दिल्याप्रमाणे औषधे घ्या आणि नियमित व्यायामाचा तुमच्या दिनक्रमात समावेश करा.',
        'दमा': 'निर्देशानुसार विहित इनहेलर वापरा आणि धूर, परागकण आणि पाळीव प्राण्यांचा कोंडा यासारख्या ट्रिगर्स टाळा.  तुमच्या डॉक्टरांनी दिलेल्या अस्थमा कृती योजनेचे अनुसरण करा.',
        'ॲलर्जी': 'परागकण, धूळ आणि पाळीव प्राण्यांचा कोंडा यासारख्या ट्रिगर्स टाळा.  लक्षणांपासून मुक्त होण्यासाठी ओव्हर-द-काउंटर अँटीहिस्टामाइन्स किंवा अनुनासिक फवारण्या वापरा.',
        'संधिवात': 'संधी लवचिकता टिकवून ठेवण्यासाठी पोहणे किंवा चालणे यासारख्या कमी-प्रभावी व्यायामामध्ये व्यस्त रहा.  वेदना आणि जळजळ कमी करण्यासाठी उष्णता किंवा थंड पॅक लावा.',
        'मायग्रेन': 'विशिष्ट पदार्थ, तणाव किंवा झोप न लागणे यासारखे ट्रिगर ओळखा आणि टाळा.  निर्देशित केल्याप्रमाणे मायग्रेनची औषधे घ्या.',
        'एक्झिमा': 'त्वचेला आर्द्रता ठेवा आणि कठोर साबण किंवा डिटर्जंट्स सारख्या ट्रिगर्स टाळा.  खाज सुटणे आणि जळजळ करण्यासाठी ओव्हर-द-काउंटर हायड्रोकॉर्टिसोन क्रीम वापरा.',
        'पुरळ': 'कोमल क्लिंझरने नियमितपणे त्वचा स्वच्छ करा आणि मुरुम उचलणे किंवा पिळणे टाळा.  बेंझॉयल पेरोक्साइड किंवा सॅलिसिलिक ऍसिड असलेले ओव्हर-द-काउंटर मुरुम उपचार वापरा.',
        'युरिनरी ट्रॅक्ट इन्फेक्शन': 'बॅक्टेरिया बाहेर काढण्यासाठी भरपूर पाणी प्या आणि वारंवार लघवी करा.  कॅफिन आणि अल्कोहोल सारख्या चिडचिड टाळा.  निर्देशानुसार विहित प्रतिजैविक घ्या.',
        'यीस्ट इन्फेक्शन': 'प्रभावित क्षेत्र स्वच्छ आणि कोरडे ठेवा.  घट्ट बसणारे कपडे टाळा आणि ओव्हर-द-काउंटर अँटीफंगल क्रीम किंवा सपोसिटरीज वापरा.',
        'दातदुखी': 'तुमचे तोंड कोमट मिठाच्या पाण्याने स्वच्छ धुवा आणि सूज असल्यास तुमच्या गालाच्या बाहेरील बाजूस कोल्ड कॉम्प्रेस लावा.  गरजेनुसार ओव्हर-द-काउंटर वेदनाशामक औषध घ्या.',
        'कोल्ड': 'लक्षणे दूर करण्यासाठी भरपूर विश्रांती घ्या, द्रव प्या आणि काउंटर-काउंटर थंड उपाय वापरा.',
        'पोटाचा विषाणू': 'स्पष्ट द्रवांनी हायड्रेटेड राहा आणि कोमल पदार्थ खा.  विश्रांती घ्या आणि विषाणूचा प्रसार रोखण्यासाठी इतरांशी संपर्क टाळा.',
        'सायनस इन्फेक्शन': 'लक्षणे दूर करण्यासाठी सलाईन नाक स्प्रे, उबदार कॉम्प्रेस आणि ओव्हर-द-काउंटर डिकंजेस्टंट वापरा.  लक्षणे कायम राहिल्यास डॉक्टरांना भेटा.',
        'मोचलेला घोटा': 'विश्रांती, बर्फ, संकुचित करा आणि घोट्याला उंच करा (RICE पद्धत).  ओव्हर-द-काउंटर वेदना निवारक वापरा आणि प्रभावित घोट्यावर भार टाकणे टाळा.',
        'तुटलेले हाड': 'तत्काळ वैद्यकीय मदत घ्या.  प्रभावित क्षेत्र स्थिर करा आणि सूज कमी करण्यासाठी बर्फ लावा.  उपचार आणि पुनर्प्राप्तीसाठी वैद्यकीय सल्ल्याचे पालन करा.',
        'कट': 'कट साबण आणि पाण्याने स्वच्छ करा, प्रतिजैविक मलम लावा आणि निर्जंतुकीकरण पट्टीने झाकून टाका.  जर कट खोल असेल किंवा रक्तस्त्राव थांबत नसेल तर वैद्यकीय मदत घ्या.',
        'bruise': 'सूज आणि वेदना कमी करण्यासाठी कोल्ड कॉम्प्रेस लावा.  शक्य असल्यास प्रभावित क्षेत्र उंच करा.  जखम गंभीर असल्यास किंवा इतर लक्षणांसह असल्यास, डॉक्टरांना भेटा.',
        'concussion': 'विश्रांती घ्या आणि लक्षणे बिघडू शकतील अशा क्रियाकलाप टाळा.  डोकेदुखी, चक्कर येणे, मळमळ किंवा गोंधळ यांसारख्या दुखापतीच्या लक्षणांचे निरीक्षण करा.  लक्षणे वाढल्यास वैद्यकीय मदत घ्या.',
        'sore back': 'प्रभावित भागात उष्णता किंवा बर्फाचे पॅक लावा आणि हलके स्ट्रेच किंवा व्यायाम करून पहा.  ओव्हर-द-काउंटर वेदना कमी करणारे देखील मदत करू शकतात.',
        'sore neck': 'बाधित भागात उष्णता किंवा बर्फाचे पॅक लावा आणि मानेच्या हलक्या स्ट्रेचचा प्रयत्न करा.  योग्य आसनाची खात्री करा आणि मानेला ताण देणारे क्रियाकलाप टाळा.',
        'सोअर शोल्डर': 'प्रभावित खांद्याला विश्रांती द्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  उष्णता किंवा बर्फाचे पॅक लावा आणि खांद्यावर हलके ताणून पहा.',
        'sore knee': 'प्रभावित गुडघ्याला विश्रांती द्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  बर्फाचे पॅक लावा आणि गुडघा उंच करा.  आधारासाठी गुडघा ब्रेस वापरण्याचा विचार करा.',
        'sore hip': 'प्रभावित कूल्हेला विश्रांती द्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  उष्णता किंवा बर्फाचे पॅक लावा आणि हलक्या हिप स्ट्रेचचा प्रयत्न करा.',
        'sore elbow': 'प्रभावित कोपर आराम करा आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  बर्फाचे पॅक लावा आणि कोपर उंच करा.  आधारासाठी कोपर ब्रेस वापरण्याचा विचार करा.',
        'sore wrist': 'प्रभावित मनगट विश्रांती घ्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  बर्फाचे पॅक लावा आणि मनगट उंच करा.  आधारासाठी मनगटातील ब्रेस वापरण्याचा विचार करा.',
        'sore ankle': 'प्रभावित घोट्याला विश्रांती द्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  बर्फाचे पॅक लावा आणि घोट्याला उंच करा.  आधारासाठी घोट्याच्या ब्रेस वापरण्याचा विचार करा.',
        'sore foot': 'प्रभावित पायाला विश्रांती द्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  बर्फाचे पॅक लावा आणि पाय उंच करा.  सपोर्टिव्ह फुटवेअर वापरण्याचा विचार करा.',
        'sore toe': 'प्रभावित पायाच्या बोटाला विश्रांती द्या आणि वेदना वाढवणाऱ्या क्रियाकलाप टाळा.  बर्फाचे पॅक लावा आणि पायाचे बोट उंच करा.  रुंद किंवा अधिक आरामदायक शूज वापरण्याचा विचार करा.',
        'हातावर पुरळ': 'प्रभावित क्षेत्र स्वच्छ आणि कोरडे ठेवा.  खाज सुटण्यासाठी सौम्य मॉइश्चरायझर किंवा कॅलामाइन लोशन लावा.  पुरळ खाजवणे टाळा.',
        'पायावर पुरळ': 'प्रभावित क्षेत्र स्वच्छ आणि कोरडे ठेवा.  खाज सुटण्यासाठी सौम्य मॉइश्चरायझर किंवा कॅलामाइन लोशन लावा.  सैल, श्वास घेण्यासारखे कपडे घाला.',
        'चेहऱ्यावर पुरळ': 'प्रभावित क्षेत्र स्वच्छ ठेवा आणि कठोर त्वचा निगा उत्पादने टाळा.  सौम्य मॉइश्चरायझर लावा आणि पुरळ उठणे टाळा.',
        'छातीवर पुरळ': 'प्रभावित क्षेत्र स्वच्छ आणि कोरडे ठेवा.  घट्ट बसणारे कपडे आणि त्रासदायक फॅब्रिक्स टाळा.  खाज सुटणे आणि जळजळ करण्यासाठी ओव्हर-द-काउंटर हायड्रोकॉर्टिसोन क्रीम वापरा.',
        'पाठीवर पुरळ': 'प्रभावित क्षेत्र स्वच्छ आणि कोरडे ठेवा.  सैल, श्वास घेण्यासारखे कपडे घाला.  खाज सुटणे आणि जळजळ होण्यासाठी ओव्हर-द-काउंटर अँटीहिस्टामाइन्स किंवा हायड्रोकॉर्टिसोन क्रीम वापरा.',
        'पोटावर पुरळ': 'प्रभावित भाग स्वच्छ आणि कोरडा ठेवा.  त्रासदायक फॅब्रिक्स आणि कठोर स्किनकेअर उत्पादने टाळा.  खाज सुटणे आणि जळजळ करण्यासाठी ओव्हर-द-काउंटर हायड्रोकॉर्टिसोन क्रीम वापरा.',
    
    }

    # Sample Medicine Suggestions
    medicines = {
        'डोकेदुखी': {
            'औषध': ['ऍस्पिरिन (₹10)', 'ॲसिटामिनोफेन (₹15)', 'इबुप्रोफेन (₹20)'],
            'when_to_take': 'आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': '1-2 गोळ्या (पॅकेजिंगवरील डोस सूचनांचे अनुसरण करा).'
        },
        'पोट दुखते': {
            'औषध': ['अँटासिड्स (₹12)', 'पेप्टो-बिस्मोल (₹25)', 'Simethicone (₹18)'],
            'when_to_take': 'जेवणानंतर आणि झोपण्यापूर्वी, किंवा तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'आवश्यकतेनुसार 1-2 गोळ्या.'
        },
        'मळमळ': {
            'औषध': ['अदरक कॅप्सूल (₹30)', 'एमेट्रोल (₹22)', 'बिस्मथ सबसॅलिसिलेट (₹28)'],
            'when_to_take': 'जेवणाच्या ३० मिनिटे आधी किंवा आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'ताप': {
            'औषध': ['Acetaminophen (₹15)', 'Ibuprofen (₹20)', 'Aspirin (₹10)'],
            'when_to_take': 'आवश्यकतेनुसार दर 4-6 तासांनी, पूर्ण ग्लास पाण्यासह.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'खोकला': {
            'औषध': ['डेक्स्ट्रोमेथोरफान (₹25)', 'ग्वाइफेनेसिन (₹18)', 'कोडाइन (₹35)'],
            'when_to_take': 'प्रत्येक 4-6 तासांनी आवश्यकतेनुसार, भरपूर द्रवपदार्थांसह.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'धाप लागणे': {
            'औषध': ['अल्ब्युटेरॉल (₹40)', 'कॉर्टिकोस्टिरॉईड्स (₹30)', 'ऑक्सिजन थेरपी (₹100)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'छाती दुखणे': {
            'औषध': ['नायट्रोग्लिसरीन (₹50)', 'ऍस्पिरिन (₹10)', 'बीटा-ब्लॉकर्स (₹35)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'घसा खवखवणे': {
            'औषध': ['घशाचे लोझेंज (₹15)', 'Acetaminophen (₹15)', 'Ibuprofen (₹20)'],
            'when_to_take': 'आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'अतिसार': {
            'औषध': ['लोपेरामाइड (₹25)', 'बिस्मथ सब्सॅलिसिलेट (₹28)', 'प्रोबायोटिक्स (₹30)'],
            'when_to_take': 'प्रत्येक सैल स्टूल नंतर, किंवा तुमच्या डॉक्टरांच्या निर्देशानुसार.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'बद्धकोष्ठता': {
            'औषध': ['फायबर सप्लिमेंट्स (₹20)', 'स्टूल सॉफ्टनर्स (₹25)', 'लॅक्सेटिव्ह (₹18)'],
            'when_to_take': 'झोपण्यापूर्वी किंवा तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'पाठदुखी': {
            'औषध': ['Acetaminophen (₹15)', 'Ibuprofen (₹20)', 'Naproxen (₹30)'],
            'when_to_take': 'आवश्यकतेनुसार दर 4-6 तासांनी, पूर्ण ग्लास पाण्यासह.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'चक्कर येणे': {
            'औषध': ['मेक्लिझिन (₹35)', 'अँटीहिस्टामाइन्स (₹18)', 'स्कोपोलामाइन पॅचेस (₹50)'],
            'when_to_take': 'आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'त्वचेवर पुरळ': {
            'औषध': ['हायड्रोकॉर्टिसोन क्रीम (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'वाहणारे नाक': {
            'औषध': ['अँटीहिस्टामाइन्स (₹18)', 'डिकॉन्जेस्टंट्स (₹20)', 'नासिक कॉर्टिकोस्टिरॉईड्स (₹30)'],
            'when_to_take': 'आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'झोपण्यात अडचण': {
            'औषध': ['मेलाटोनिन (₹25)', 'डायफेनहायड्रॅमिन (₹20)', 'ट्राझोडोन (₹35)'],
            'when_to_take': 'झोपण्याच्या 30 मिनिटे आधी, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'धूसर दृष्टी': {
            'औषध': ['प्रिस्क्रिप्शन चष्मा (₹200)', 'कॉन्टॅक्ट लेन्स (₹150)', 'डोळ्याचे थेंब (₹30)'],
            'when_to_take': 'आवश्यकतेनुसार किंवा तुमच्या डोळ्यांच्या डॉक्टरांच्या निर्देशानुसार.',
            'quantity': 'वापराच्या सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'सांधे दुखी': {
            'औषध': ['Acetaminophen (₹15)', 'Ibuprofen (₹20)', 'Naproxen (₹30)'],
            'when_to_take': 'आवश्यकतेनुसार दर 4-6 तासांनी, पूर्ण ग्लास पाण्यासह.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'स्नायू पेटके': {
            'औषध': ['हायड्रेशन (₹0)', 'मॅग्नेशियम सप्लिमेंट्स (₹25)', 'क्विनाइन (₹35)'],
            'when_to_take': 'आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'उच्च रक्तदाब': {
            'औषध': ['अँटीहाइपरटेन्सिव्ह औषधे (₹45)', 'लघवीचे प्रमाण वाढवणारी (₹30)', 'बीटा-ब्लॉकर्स (₹35)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'मधुमेह': {
            'औषध': ['इन्सुलिन (₹200)', 'तोंडी औषधे (₹100)', 'रक्तातील साखरेचे निरीक्षण (₹50)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'दमा': {
            'औषध': ['इनहेल्ड कॉर्टिकोस्टिरॉईड्स (₹80)', 'ब्रॉन्कोडायलेटर्स (₹60)', 'ल्युकोट्रिन मॉडिफायर्स (₹70)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'ऍलर्जी': {
            'औषध': ['अँटीहिस्टामाइन्स (₹18)', 'डिकॉन्जेस्टंट्स (₹20)', 'कॉर्टिकोस्टिरॉईड्स (₹30)'],
            'when_to_take': 'आवश्यकतेनुसार किंवा तुमच्या डॉक्टरांच्या निर्देशानुसार.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'संधिवात': {
            'औषध': ['NSAIDs (₹25)', 'Corticosteroids (₹30)', 'DMARDs (₹50)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'मायग्रेन': {
            'औषध': ['Triptans (₹50)', 'Ergotamine (₹45)', 'Acetaminophen with caffeine (₹25)'],
            'when_to_take': 'मायग्रेनची लक्षणे दिसू लागल्यावर, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'एक्झामा': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'इमोलियंट्स (₹30)'],
            'when_to_take': 'निर्देशानुसार प्रभावित त्वचेवर लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'पुरळ': {
            'औषध': ['बेंझॉयल पेरोक्साइड (₹30)', 'सॅलिसिलिक ऍसिड (₹25)', 'टॉपिकल रेटिनॉइड्स (₹40)'],
            'when_to_take': 'निर्देशानुसार प्रभावित त्वचेवर लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'मूत्रमार्गाच्या भागातील संसर्ग': {
            'औषध': ['अँटीबायोटिक्स (₹50)', 'वेदना कमी करणारे (₹20)', 'मूत्र वेदनाशामक (₹30)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'यीस्ट संसर्ग': {
            'औषध': ['अँटीफंगल औषधे (₹45)', 'टॉपिकल क्रीम्स (₹35)', 'ओरल टॅब्लेट (₹50)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'दातदुखी': {
            'औषध': ['Acetaminophen (₹15)', 'Ibuprofen (₹20)', 'Benzocaine gel (₹30)'],
            'when_to_take': 'आवश्यकतेनुसार, पूर्ण ग्लास पाणी घेऊन.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'थंड': {
            'औषध': ['Acetaminophen (₹15)', 'Ibuprofen (₹20)', 'decongestants (₹25)'],
            'when_to_take': 'आवश्यकतेनुसार दर 4-6 तासांनी, पूर्ण ग्लास पाण्यासह.',
            'quantity': 'पॅकेजिंगवरील डोस सूचनांचे पालन करा.'
        },
        'पोटाचा विषाणू': {
            'औषध': ['ओरल रीहायड्रेशन सोल्यूशन्स (₹40)', 'अँटीमेटिक्स (₹30)', 'अँटी डायरियाल औषधे (₹35)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'नाकाशी संबंधित संसर्ग': {
            'औषध': ['अँटीबायोटिक्स (₹50)', 'डीकंजेस्टंट्स (₹25)', 'सलाइन नाक स्प्रे (₹20)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'मोठ्याचा घोटा': {
            'औषध': ['राईस थेरपी (₹0)', 'NSAIDs (₹25)', 'एंकल ब्रेस (₹50)'],
            'when_to_take': 'आवश्यकतेनुसार किंवा तुमच्या डॉक्टरांच्या निर्देशानुसार.',
            'quantity': 'वापराच्या सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'तुटलेले हाड': {
            'औषध': ['इमोबिलायझेशन (₹0)', 'वेदना कमी करणारे (₹20)', 'बोन स्टिम्युलेटर (₹40)'],
            'when_to_take': 'तुमच्या डॉक्टरांनी सांगितल्याप्रमाणे.',
            'quantity': 'डोस सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'कट': {
            'औषध': ['अँटीसेप्टिक द्रावण (₹20)', 'अँटीबायोटिक मलम (₹30)', 'निर्जंतुकीकरण मलमपट्टी (₹15)'],
            'when_to_take': 'निर्देशानुसार जखमेवर लावा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'घास': {
            'औषध': ['कोल्ड कॉम्प्रेस (₹10)', 'अर्निका जेल (₹35)', 'वेदना निवारक (₹20)'],
            'when_to_take': 'आवश्यकतेनुसार जखम झालेल्या ठिकाणी लावा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'कंक्शन': {
            'औषध': ['विश्रांती (₹0)', 'वेदना निवारक (₹20)', 'मेंदू विश्रांती (₹0)'],
            'when_to_take': 'आवश्यकतेनुसार किंवा तुमच्या डॉक्टरांच्या निर्देशानुसार.',
            'quantity': 'वापराच्या सूचना किंवा डॉक्टरांच्या सल्ल्याचे पालन करा.'
        },
        'माझ्या हातावर पुरळ': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'माझ्या पायावर पुरळ': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'माझ्या चेहऱ्यावर पुरळ': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'माझ्या छातीवर पुरळ': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'माझ्या पाठीवर पुरळ': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
        'माझ्या पोटावर पुरळ': {
            'औषध': ['टॉपिकल कॉर्टिकोस्टिरॉईड्स (₹40)', 'अँटीहिस्टामाइन्स (₹18)', 'कॅलामाइन लोशन (₹25)'],
            'when_to_take': 'दिग्दर्शित केल्याप्रमाणे प्रभावित भागात लागू करा.',
            'quantity': 'पॅकेजिंगवरील वापर सूचनांचे अनुसरण करा.'
        },
    }



    # Sample Diet Recommendations
    diet_recommendations = {
        'डोकं दुखणे': 'सुनिल्या ठिकण्यांमध्ये सुरक्षित राहण्यासाठी खूप पाण्य प्या आणि मॅग्नेशियममध्ये समृद्ध असलेल्या आहारींसह नाश्ता करा, जसे की आलीव्ह, पालंग, आणि केळी. चहा आणि दारूनीच्या पेय पदार्थांचे सेवन करणे टाळा.',
        'पोटात दुखणे': 'केळी, भात, आपल्सॉस, आणि टोस्ट (बीआरएटी आहार) यांच्यावर सोबत ठीक घट्ट, दिग्ध, किंवा जिरा आहाराचे सेवन करा. तीव्र, तिखट किंवा मोठे आहार टाळा.',
        'ताप': 'पाण्याच्या, स्पष्ट ब्रॉथ, आणि इलेक्ट्रोलाईट-समृद्ध पेय पदार्थांमध्ये गुंज द्या. सादं, गरम देसी, आणि भाजलेल्या वनस्पतींसारख्या आहारांसह व्यक्तिमत्ता करा.',
        'कफ': 'पुरेपाण्यासह पिण्यात येणारा पाणी, औषधीय चहा, आणि स्पष्ट ब्रॉथसारख्या प्राणांशी पुरणा करणारा पाणी पिण्यात येतो. गरम तुप, मध, आणि आलं आदी चहा जसे अस्थाईच्या आहारांसह प्राणांशी पुरणा करा.'
    }

    # Preprocessingd
    def preprocess_text(text):
        text = text.lower()
        text = ''.join([char for char in text if char not in string.punctuation])
        return text

    # TF-IDF Vectorization
    tfidf_vectorizer = TfidfVectorizer(tokenizer=nltk.word_tokenize, stop_words='english', token_pattern=None)
    tfidf_matrix = tfidf_vectorizer.fit_transform([preprocess_text(sentence) for sentence in corpus])

    # Function to generate bot response
    def get_bot_response(user_input):
        user_input = preprocess_text(user_input)
        user_tfidf = tfidf_vectorizer.transform([user_input])

        # Calculate similarity between user input and corpus
        similarities = cosine_similarity(user_tfidf, tfidf_matrix)
        idx = np.argmax(similarities)
        
        
        # Check if the input matches a rule
        for condition, rule in rules.items():
            if condition in user_input:
                if condition in medicines:
                    medicine_info = medicines[condition]
                    if 'medicine' in medicine_info:  # Check if 'medicine' key exists
                        medicine_suggestion = random.choice(medicine_info['medicine'])
                        response = f"{rule}\nआपल्या {condition} काळजी घेण्यासाठी {medicine_suggestion} {medicine_info['when_to_take']} घ्या. प्रमाण: {medicine_info['quantity']}."
                        if condition in diet_recommendations:
                            response += f"\nअधिक माहितीसाठी, आपल्या {condition}, {diet_recommendations[condition]}"
                        return response
                    else:
                        response = rule
                        if condition in diet_recommendations:
                            response += f"\nअधिक माहितीसाठी, आपल्या {condition}, {diet_recommendations[condition]}"
                            speak(response)
                        return response
        
        # If no match found, return "Please try again"
        return "कृपया पुन्हा प्रयत्न करा."
    def speak(text):
    # Initialize the TTS engine
        engine = pyttsx3.init()

        # Set properties (optional)
        engine.setProperty('rate', 150)  # Speed of speech
        engine.setProperty('volume', 0.9)  # Volume level

        # Speak the text
        engine.say(text)
        engine.runAndWait()
    # Function to handle speech recognition
    def recognize_speech():
        recognizer = sr.Recognizer()
        with sr.Microphone() as source:
            recognizer.adjust_for_ambient_noise(source)
            audio = recognizer.listen(source)
        
        try:
            user_input = recognizer.recognize_google(audio, language='mr-IN')  # Change language to Marathi
            entry.delete(0, tk.END)
            entry.insert(tk.END, user_input)
        except sr.UnknownValueError:
            entry.delete(0, tk.END)
            entry.insert(tk.END, "ऑडियो समजलं नाही. कृपया स्पष्टपणे बोला किंवा आपले संदेश टाइप करा.")
        except sr.RequestError as e:
            entry.delete(0, tk.END)
            entry.insert(tk.END, f"त्रुटी: {e}")

    # Function to handle user input and display bot response
    def send():
        user_input = entry.get()
        if user_input.strip() != "":
            if user_input.lower() in ['नमस्कार', 'मदत करा', 'मदत करा', 'हैलो', 'हाय', 'नमस्कार', 'मला काही समस्या आहेत']:
                bot_response = "सेहत साथीवर आपले स्वागत आहे. कृपया मला आपली समस्या सांगा."
            elif user_input.lower() in ['बाय', 'गुड बाय']:
                bot_response = "धन्यवाद! आपला दिवस शुभ असो. आपल्या आरोग्याची काळजी घ्या."
            else:
                bot_response = get_bot_response(user_input)
            
            chat_log.config(state=tk.NORMAL)
            chat_log.insert(tk.END, "तुमचं: " + user_input + "\n\n", "user")
            chat_log.insert(tk.END, "सेहत साथी: " + bot_response + "\n\n", "bot")
            chat_log.config(state=tk.DISABLED)
            
            # Scroll to the bottom
            chat_log.see(tk.END)
            
            engine.say(bot_response)
            engine.runAndWait()
            
            entry.delete(0, tk.END)

    # GUI Setup
    root = tk.Tk()
    root.title("सेहत साथी")
    root.configure(bg="#FDFEFE")  # Set background color

    frame = tk.Frame(root, bg="#FDFEFE")  # Set background color
    scrollbar = tk.Scrollbar(frame)
    chat_log = tk.Text(frame, height=25, width=50, yscrollcommand=scrollbar.set, bg="#FDFEFE", wrap="word")
    scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
    chat_log.pack(side=tk.LEFT, fill=tk.BOTH, padx=5, pady=5)
    frame.pack()

    entry_frame = tk.Frame(root, bg="#FDFEFE")  # Set background color
    entry = tk.Entry(entry_frame, width=50, bg="#E5E7E9")
    entry.pack(pady=10, side=tk.LEFT)
    send_button = tk.Button(entry_frame, text="पाठवा", command=send, bg="#4CAF50", fg="white")  # Set button color
    send_button.pack(side=tk.LEFT)
    mic_button = tk.Button(entry_frame, text="🎤", command=recognize_speech, bg="#4CAF50", fg="white")  # Set button color
    mic_button.pack(side=tk.LEFT)
    entry_frame.pack()

    # Configure chat log text style
    chat_log.tag_configure("user", foreground="blue")  # Set color for user messages
    chat_log.tag_configure("bot", foreground="red")  # Set color for bot messages

    # Run GUI
    root.mainloop()